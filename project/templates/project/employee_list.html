<!-- use base html template -->
{% extends 'project/base.html' %}
{% block title %}
    <title>مدیریت کارمندان</title>
{% endblock %}
<!-- begin of body block -->
{% block body %}
    <!-- load static file in django -->
    {% load staticfiles %}
    <link rel="stylesheet" href="{% static 'project/styles.css' %}">

    <div class="alert alert-primary" role="alert">
        کارمندها
    </div>

    <!-- body -->
    <div class="row mx-auto">
        <div class="col-12 col-md-12">
            <div class="row mx-auto d-flex flex-center" id="product-list">

                {% for employee in employees %}
                    <!-- Card -->
                    <div class="card testimonial-card col-width m-1">

                        <!-- Background color -->
                        <div class="card-up indigo lighten-1"></div>

                        <!-- Avatar -->
                        <a href="{% url 'project:employee-detail' employee.id%}">
                            {% if employee.pic %}
                                <div class="avatar mx-auto white">
                                    <img src="{{ employee.pic.url }}" class="rounded-circle" alt="{{ employee.fullName }}">
                                </div>
                            {% else %}
                                <div class="avatar mx-auto white">
                                    <img src="{% static 'project/images/Blank-Placeholder.jpg' %}" class="rounded-circle" alt="{{ employee.fullName }}">
                                </div>
                            {%  endif %}
                        </a>

                        <!-- Content -->
                        <div class="card-body">
                            <!-- Name -->
                            <a href="{% url 'project:employee-detail' employee.id%}">
                                <h4 class="card-title">{{ employee.fullName }}</h4>
                            </a>
                            <hr>
                            <!-- Quotation -->
                            <p><i class="fas fa-money-bill"></i> {{ employee.salary }} <br>  <i class="fas fa-calendar-alt"></i> {{ employee.startDate }}</p>
                            <p>
                                <a href="{% url 'project:employee-update' employee.id %}"><i class="fas fa-edit" style="color: #0b51c5"></i></a>
                                <a onclick="showDeleteModalEmployee({{ employee.id }})" data-toggle="modal" data-target="#basicExampleModalEmployee"><i class="fas fa-trash"></i></a>
                            </p>
                        </div>

                    </div>
                {% endfor %}

            </div>
            <div class="mx-auto my-4" id="products-loading"></div>

            <!-- add new employee -->
            <div class="mx-auto my-4">
                <a href="{% url "project:employee-create" %}" >
                    <button type="button" class="btn-lg btn-default btn-floating"><i class="fa fa-plus"></i></button>
                </a>
            </div>

        </div>

    </div>

    <!-- Modal -->
    <input type="hidden" id="selected-employee-delete-id" selected-id="2">
    <input type="hidden" id="selected-employee-delete-title" selected-employee="2">
    <div class="modal fade" id="basicExampleModalEmployee" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
      aria-hidden="true">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel"></h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div id="model-bode-employee" class="modal-body">
            متن مودال
          </div>
          <div id="model-employee-tag" class="modal-footer">
              <button type="button" class="btn btn-info" data-dismiss="modal">انصراف</button>
              <a >
                  <button type="button" class="btn btn-secondary">تایید</button>
              </a>
          </div>
        </div>
      </div>
    </div>

    <input type="hidden" id="url-base" data-url="http://{{ request.get_host }}/" />

    <script>
        function showDeleteModalEmployee(employee_id, employee_title=" ") {
            console.log("done")
            $("#selected-employee-delete-id").attr("selected-id", employee_id);
            $("#selected-employee-delete-title").attr("selected-employee", employee_title);
            let idd = $("#selected-employee-delete-id").attr("selected-id");
            let a_tag = $("#model-employee-tag");
            let body = $("#model-bode-employee");
            let base_url = $("#url-base").attr("data-url");
            a_tag.empty();
            a_tag.append(
                `<button type="button" class="btn btn-info" data-dismiss="modal">انصراف</button>` +
                `<a href='${base_url}${idd}/employee-delete/'">` +
                    `<button type="button" class="btn btn-secondary">تایید</button>` +
                `</a>`
            );
            body.empty();
            body.append(
                `آیا از حذف کترمند مطمئن هستید؟`
            );
        }
    </script>

<!-- end of body block -->
{% endblock %}


